<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SVG Morph: Square â†” Circle</title>
  <style>
    body { display: flex; justify-content: center; align-items: center; height: 100vh; background: #111; }
    svg { width: 300px; height: 300px; cursor: pointer; }
    path { fill: #00bcd4; transition: fill 0.3s; }
  </style>
</head>
<body>

<svg viewBox="0 0 100 100" id="svg">
  <path id="morph" d="" />
</svg>

<script>
  const pathEl = document.getElementById('morph');
  
// looks like a cool N
//    const square = [
//    [10,10, 10,10, 10,10, 10,90],
//    [10,90, 10,90, 90,90, 90,90],
//    [90,90, 90,90, 90,10, 90,10],
//    [90,10, 90,10, 10,10, 10,10]
//  ];

//  const circle = [
//    [10,10, 10,27, 27,10, 10,90],
//    [10,90, 73,10, 90,27, 90,90],
//    [90,90, 90,73, 73,90, 90,10],
//    [90,10, 27,90, 10,73, 10,10]
//  ];
 

  // Both paths must have same number of commands and structure (8 numbers per cubic segment)
  const square = [
    [10,10, 10,10, 10,10, 10,90],
    [10,90, 10,90, 90,90, 90,90],
    [90,90, 90,90, 90,10, 90,10],
    [90,10, 90,10, 10,10, 10,10]
  ];

  const circle = [
    [10,10, 50,50, 50,50, 10,90],
    [10,90, 50,50, 50,50, 90,90],
    [90,90, 50,50, 50,50, 90,10],
    [90,10, 50,50, 50,50, 10,10]
  ];

  let progress = 0;
  let direction = 1; // 1 for forward, -1 for reverse
  let animating = false;
  let lastTimestamp = null;

  const duration = 1000; // milliseconds

  function interpolatePath(p1, p2, t) {
    return p1.map((seg, i) => {
      return seg.map((v, j) => {
        return v + (p2[i][j] - v) * t;
      });
    });
  }

  function pathToString(path) {
    let d = `M ${path[0][0]} ${path[0][1]} `;
    for (let i = 0; i < path.length; i++) {
      d += `C ${path[i][2]} ${path[i][3]}, ${path[i][4]} ${path[i][5]}, ${path[i][6]} ${path[i][7]} `;
    }
    d += 'Z';
    return d.trim();
  }

  function animate(timestamp) {
    if (!lastTimestamp) lastTimestamp = timestamp;
    const delta = timestamp - lastTimestamp;
    lastTimestamp = timestamp;

    const deltaProgress = delta / duration * direction;
    progress += deltaProgress;
    progress = Math.min(Math.max(progress, 0), 1);

    const currentPath = interpolatePath(square, circle, progress);
    pathEl.setAttribute('d', pathToString(currentPath));

    if ((direction === 1 && progress < 1) || (direction === -1 && progress > 0)) {
      requestAnimationFrame(animate);
    } else {
      animating = false;
    }
  }

  document.getElementById('svg').addEventListener('click', () => {
    if (!animating) {
      direction = progress === 0 ? 1 : -1;
      animating = true;
      lastTimestamp = null;
      requestAnimationFrame(animate);
    } else {
      // Reverse mid-animation
      direction *= -1;
      lastTimestamp = null;
      animating = true;
      requestAnimationFrame(animate);
    }
  });

  // Initialize with square
  pathEl.setAttribute('d', pathToString(square));
</script>

</body>
</html>